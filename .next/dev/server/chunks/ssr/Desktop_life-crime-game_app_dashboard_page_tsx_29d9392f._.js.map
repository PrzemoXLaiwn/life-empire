{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Montech.DESKTOP-HFD37TP/Desktop/life-crime-game/app/dashboard/page.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useMemo, useState } from 'react'\r\nimport Link from 'next/link'\r\nimport {\r\n  Trophy, Zap, Target, Globe, Briefcase, ShoppingBag, Shield, Swords, Home, Users, Dumbbell\r\n} from 'lucide-react'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { useCharacterStore } from '@/lib/character-store'\r\n\r\n// ===== Typy =====\r\ntype City = { name: string; country: string }\r\ntype Character = {\r\n  money: number\r\n  level: number\r\n  energy: number\r\n  maxEnergy: number\r\n  reputation: number\r\n  city?: City | null\r\n}\r\n\r\n// Formatery\r\nconst currencyFmt = new Intl.NumberFormat('en-US', {\r\n  style: 'currency',\r\n  currency: 'USD',\r\n  maximumFractionDigits: 0,\r\n})\r\n\r\nconst numberFmt = new Intl.NumberFormat('en-US')\r\n\r\n// ===== Reu≈ºywalne karty =====\r\nfunction StatCard({\r\n  label,\r\n  value,\r\n  className = '',\r\n}: {\r\n  label: string\r\n  value: string\r\n  className?: string\r\n}) {\r\n  return (\r\n    <div className=\"ls-section\">\r\n      <div className=\"ls-section-content text-center\">\r\n        <p className={`text-3xl font-bold mb-1 ${className}`}>{value}</p>\r\n        <p className=\"text-xs text-[#888] uppercase\">{label}</p>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction QuickActionCard({\r\n  href,\r\n  icon: Icon,\r\n  label,\r\n  hoverBorder = '#333',\r\n  iconClass = '',\r\n  ariaLabel,\r\n}: {\r\n  href: string\r\n  icon: React.ComponentType<React.SVGProps<SVGSVGElement>>\r\n  label: string\r\n  hoverBorder?: string\r\n  iconClass?: string\r\n  ariaLabel?: string\r\n}) {\r\n  return (\r\n    <Link href={href} className=\"group\" aria-label={ariaLabel ?? label} prefetch>\r\n      <div\r\n        className=\"p-4 bg-[#1a1a1a] border border-[#333] transition-all rounded\r\n                   hover:scale-105 focus-within:scale-105 outline-none\r\n                   focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[#5cb85c]\r\n                   focus-visible:ring-offset-[#0c0c0c]\"\r\n        style={{ boxShadow: '0 0 0 0 rgba(0,0,0,0)' }}\r\n      >\r\n        <Icon className={`w-8 h-8 mx-auto mb-2 transition-transform group-hover:scale-110 ${iconClass}`} />\r\n        <div className=\"text-xs font-bold text-[#fff] text-center\">{label}</div>\r\n      </div>\r\n    </Link>\r\n  )\r\n}\r\n\r\nexport default function DashboardPage() {\r\n  // Precyzyjne selektory = mniej rerender√≥w\r\n  const character = useCharacterStore((s) => s.character) as Character | null\r\n  const isLoading = useCharacterStore((s) => s.isLoading)\r\n  const [username, setUsername] = useState<string>('Player')\r\n  const [authLoading, setAuthLoading] = useState<boolean>(true)\r\n  const [authError, setAuthError] = useState<string | null>(null)\r\n\r\n  const supabase = useMemo(() => createClient(), [])\r\n\r\n  // Wczytanie username z Supabase z bezpiecznym odmontowaniem\r\n  useEffect(() => {\r\n    let isActive = true\r\n    ;(async () => {\r\n      setAuthLoading(true)\r\n      setAuthError(null)\r\n      try {\r\n        const { data, error } = await supabase.auth.getUser()\r\n        if (error) throw error\r\n        const user = data?.user\r\n        if (!user) {\r\n          if (isActive) setUsername('Player')\r\n          return\r\n        }\r\n        const metaName = (user.user_metadata as any)?.username as string | undefined\r\n        const fallbackFromEmail = user.email?.split('@')[0]\r\n        if (isActive) setUsername(metaName || fallbackFromEmail || 'Player')\r\n      } catch (e: any) {\r\n        if (isActive) {\r\n          setAuthError('Could not load profile')\r\n          setUsername('Player')\r\n        }\r\n      } finally {\r\n        if (isActive) setAuthLoading(false)\r\n      }\r\n    })()\r\n    return () => {\r\n      isActive = false\r\n    }\r\n  }, [supabase])\r\n\r\n  // Lista akcji ‚Äì jedna deklaracja, zero duplikacji\r\n  const actions = useMemo(\r\n    () => [\r\n      { href: '/dashboard/crimes', icon: Target, label: 'Crime', hoverBorder: 'var(--danger)', iconClass: 'text-danger' },\r\n      { href: '/dashboard/gym', icon: Dumbbell, label: 'Gym', hoverBorder: 'var(--warning)', iconClass: 'text-warning' },\r\n      { href: '/dashboard/jobs', icon: Briefcase, label: 'Jobs', hoverBorder: 'var(--success)', iconClass: 'text-success' },\r\n      { href: '/dashboard/travel', icon: Globe, label: 'Travel', hoverBorder: 'var(--info)', iconClass: 'text-info' },\r\n      { href: '/dashboard/city', icon: Home, label: 'City', hoverBorder: '#888', iconClass: 'text-[#888]' },\r\n      { href: '/dashboard/market', icon: ShoppingBag, label: 'Market', hoverBorder: '#f0ad4e', iconClass: 'text-[#f0ad4e]' },\r\n      { href: '/dashboard/combat', icon: Swords, label: 'Combat', hoverBorder: 'var(--danger)', iconClass: 'text-danger' },\r\n      { href: '/dashboard/gang', icon: Shield, label: 'Gang', hoverBorder: '#9b59b6', iconClass: 'text-[#9b59b6]' },\r\n    ],\r\n    []\r\n  )\r\n\r\n  // Wsp√≥lny loader\r\n  if (isLoading || !character) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-screen\">\r\n        <div className=\"text-center\">\r\n          {/* prosty skeleton/loader */}\r\n          <div className=\"inline-block h-8 w-8 animate-spin rounded-full border-2 border-solid border-[#5cb85c] border-r-transparent mb-4\"></div>\r\n          <p className=\"text-[#888] text-xs uppercase\">Loading...</p>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6 max-w-7xl mx-auto fade-in\">\r\n      {/* Header */}\r\n      <div className=\"ls-section\">\r\n        <div className=\"ls-section-content\">\r\n          <h1 className=\"text-3xl font-bold text-[#fff] mb-1\">\r\n            Welcome back, {authLoading ? '...' : username}! üëã\r\n          </h1>\r\n          {!!authError && <p className=\"text-xs text-danger mb-1\">{authError}</p>}\r\n          <p className=\"text-sm text-[#888]\">\r\n            {character.city\r\n              ? `You're currently in ${character.city.name}, ${character.city.country}`\r\n              : 'Select a city to begin your journey'}\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats */}\r\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n        <StatCard label=\"Cash\" value={currencyFmt.format(character.money)} className=\"text-success\" />\r\n        <StatCard label=\"Level\" value={numberFmt.format(character.level)} className=\"text-info\" />\r\n        <StatCard\r\n          label=\"Energy\"\r\n          value={`${numberFmt.format(character.energy)}/${numberFmt.format(character.maxEnergy)}`}\r\n          className=\"text-warning\"\r\n        />\r\n        <StatCard label=\"Reputation\" value={numberFmt.format(character.reputation)} className=\"text-[#d0d0d0]\" />\r\n      </div>\r\n\r\n      {/* Quick Actions */}\r\n      <div className=\"ls-section\">\r\n        <div className=\"ls-section-header\">Quick Actions</div>\r\n        <div className=\"ls-section-content\">\r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-3\">\r\n            {actions.map((a) => (\r\n              <QuickActionCard\r\n                key={a.href}\r\n                href={a.href}\r\n                icon={a.icon}\r\n                label={a.label}\r\n                hoverBorder={a.hoverBorder}\r\n                iconClass={a.iconClass}\r\n                ariaLabel={`Open ${a.label}`}\r\n              />\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Top Players & Achievements */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n        <div className=\"ls-section\">\r\n          <div className=\"ls-section-header\">\r\n            <Trophy className=\"w-4 h-4 inline mr-2\" />\r\n            Top Players\r\n          </div>\r\n          <div className=\"ls-section-content\">\r\n            <p className=\"text-xs text-[#888] text-center py-8\">üèÜ Leaderboard coming soon!</p>\r\n            <Link href=\"/dashboard/leaderboard\" className=\"ls-btn ls-btn-primary w-full text-center\" prefetch>\r\n              View Leaderboard\r\n            </Link>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"ls-section\">\r\n          <div className=\"ls-section-header\">\r\n            <Users className=\"w-4 h-4 inline mr-2\" />\r\n            Online Players\r\n          </div>\r\n          <div className=\"ls-section-content\">\r\n            <p className=\"text-xs text-[#888] text-center py-8\">üü¢ See who&apos;s online!</p>\r\n            <Link href=\"/dashboard/players\" className=\"ls-btn ls-btn-secondary w-full text-center\" prefetch>\r\n              Browse Players\r\n            </Link>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Daily Challenges */}\r\n      <div className=\"ls-section\">\r\n        <div className=\"ls-section-header\">\r\n          <Zap className=\"w-4 h-4 inline mr-2\" />\r\n          Daily Challenges\r\n        </div>\r\n        <div className=\"ls-section-content\">\r\n          <div className=\"text-center py-12\">\r\n            <div className=\"text-6xl mb-4\">üéØ</div>\r\n            <p className=\"text-sm text-[#888] mb-4\">Complete daily missions for exclusive rewards!</p>\r\n            <div className=\"inline-flex items-center gap-2 px-4 py-2 bg-[#1a1a1a] border border-[#333] rounded\">\r\n              <span className=\"text-xs text-[#888]\">Coming soon</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}